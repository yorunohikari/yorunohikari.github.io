<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Japanese Language Progress Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 20px 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 28px;
            font-weight: 300;
            letter-spacing: 2px;
        }

        .header p {
            margin-top: 5px;
            opacity: 0.9;
            font-size: 14px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .student-selector {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }

        .student-selector select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            background: white;
        }

        .student-selector select:focus {
            outline: none;
            border-color: #2a5298;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .summary-card {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.08);
        }

        .summary-card h3 {
            color: #2a5298;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: 600;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .metric:last-child {
            border-bottom: none;
        }

        .metric-label {
            font-weight: 500;
        }

        .metric-value {
            font-weight: 600;
            color: #2a5298;
        }

        .strength-indicator {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }

        .strength {
            background-color: #d4edda;
            color: #155724;
        }

        .weakness {
            background-color: #f8d7da;
            color: #721c24;
        }

        .neutral {
            background-color: #fff3cd;
            color: #856404;
        }

        .weekly-progress {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }

        .weekly-progress h3 {
            color: #2a5298;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: 600;
        }

        .week-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .week-card {
            border: 1px solid #ddd;
            border-radius: 6px;
            overflow: hidden;
        }

        .week-header {
            background-color: #2a5298;
            color: white;
            padding: 12px 15px;
            font-weight: 600;
            text-align: center;
        }

        .week-content {
            padding: 15px;
        }

        .day-score {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .day-score:last-child {
            border-bottom: none;
        }

        .day-name {
            font-weight: 500;
            min-width: 80px;
        }

        .scores {
            display: flex;
            gap: 10px;
        }

        .score-item {
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            min-width: 35px;
            text-align: center;
        }

        .moji-score {
            background-color: #e3f2fd;
            color: #1565c0;
        }

        .goi-score {
            background-color: #f3e5f5;
            color: #7b1fa2;
        }

        .bunpou-score {
            background-color: #e8f5e8;
            color: #2e7d32;
        }

        .sunday-special {
            background-color: #fff3e0;
            border-left: 4px solid #ff9800;
        }

        .chart-container {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.08);
        }

        .chart-container h3 {
            color: #2a5298;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: 600;
        }

        .legend {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 2px;
        }

        .no-student {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 40px;
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .week-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 20px 15px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Japanese Language Progress Tracker</h1>
        <p>文字 (Moji) • 語彙 (Goi) • 文法 (Bunpou)</p>
    </div>

    <div class="container">
        <div class="student-selector">
            <select id="studentSelect">
                <option value="">Select a student...</option>
            </select>
        </div>

        <div id="studentData" style="display: none;">
            <div class="dashboard">
                <div class="summary-card">
                    <h3>Overall Performance</h3>
                    <div class="metric">
                        <span class="metric-label">Daily Average (Mon-Sat)</span>
                        <span class="metric-value" id="dailyAvg">-</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Weekly Average (Sunday)</span>
                        <span class="metric-value" id="weeklyAvg">-</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Total Tests Taken</span>
                        <span class="metric-value" id="totalTests">-</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Best Performance</span>
                        <span class="metric-value" id="bestDay">-</span>
                    </div>
                </div>

                <div class="summary-card">
                    <h3>Subject Analysis</h3>
                    <div class="metric">
                        <span class="metric-label">文字 (Moji)</span>
                        <span class="metric-value" id="mojiAvg">-</span>
                        <span class="strength-indicator" id="mojiStrength">-</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">語彙 (Goi)</span>
                        <span class="metric-value" id="goiAvg">-</span>
                        <span class="strength-indicator" id="goiStrength">-</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">文法 (Bunpou)</span>
                        <span class="metric-value" id="bunpouAvg">-</span>
                        <span class="strength-indicator" id="bunpouStrength">-</span>
                    </div>
                </div>
            </div>

            <div class="weekly-progress">
                <h3>Weekly Progress</h3>
                <div class="week-grid" id="weekGrid"></div>
            </div>

            <div class="chart-container">
                <h3>Progress Trend</h3>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #1565c0;"></div>
                        <span>文字 (Moji)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #7b1fa2;"></div>
                        <span>語彙 (Goi)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #2e7d32;"></div>
                        <span>文法 (Bunpou)</span>
                    </div>
                </div>
                <canvas id="progressChart" width="800" height="300"></canvas>
            </div>
        </div>

        <div id="noStudent" class="no-student">
            <p>Please select a student to view their progress data.</p>
        </div>
    </div>

    <script>
        const studentData = {
            "Osha": {
                "week1": {
                    "monday": { "moji": 5, "goi": 3, "bunpou": 3 },
                    "tuesday": { "moji": 3, "goi": 4, "bunpou": 1 },
                    "wednesday": { "moji": 4, "goi": 3, "bunpou": 3 },
                    "thursday": { "moji": 5, "goi": 4, "bunpou": 2 },
                    "friday": { "moji": 3, "goi": 0, "bunpou": 2 },
                    "saturday": { "moji": 4, "goi": 1, "bunpou": 1 },
                    "sunday": { "moji": 9, "goi": 5, "bunpou": 6 }
                },
                "week2": {
                    "monday": { "moji": 3, "goi": 2, "bunpou": 2 },
                    "tuesday": { "moji": 3, "goi": 2, "bunpou": 3 },
                    "wednesday": { "moji": 3, "goi": 1, "bunpou": 0 },
                    "thursday": { "moji": 3, "goi": 2, "bunpou": 1 },
                    "friday": { "moji": 4, "goi": 1, "bunpou": 1 },
                    "saturday": { "moji": 4, "goi": 3, "bunpou": 3 },
                    "sunday": { "moji": 9, "goi": 8, "bunpou": 4 }
                },
                "week3": {
                    "monday": { "moji": 2, "goi": 2, "bunpou": 0 },
                    "tuesday": { "moji": 3, "goi": 2, "bunpou": 1 },
                    "wednesday": { "moji": 3, "goi": 3, "bunpou": 2 },
                    "thursday": { "moji": 3, "goi": 3, "bunpou": 1 },
                    "friday": { "moji": 3, "goi": 3, "bunpou": 2 },
                    "saturday": { "moji": 3, "goi": 0, "bunpou": 0 },
                    "sunday": { "moji": 9, "goi": 7, "bunpou": 6 }
                }
            },
            "Sato Yuki": {
                "week1": {
                    "monday": { "moji": 3, "goi": 4, "bunpou": 3 },
                    "tuesday": { "moji": 4, "goi": 3, "bunpou": 4 },
                    "wednesday": { "moji": 2, "goi": 4, "bunpou": 3 },
                    "thursday": { "moji": 3, "goi": 3, "bunpou": 4 },
                    "friday": { "moji": 4, "goi": 4, "bunpou": 3 },
                    "saturday": { "moji": 3, "goi": 4, "bunpou": 4 },
                    "sunday": { "moji": 8, "goi": 9, "bunpou": 7 }
                },
                "week2": {
                    "monday": { "moji": 4, "goi": 4, "bunpou": 4 },
                    "tuesday": { "moji": 3, "goi": 5, "bunpou": 4 },
                    "wednesday": { "moji": 4, "goi": 3, "bunpou": 5 },
                    "thursday": { "moji": 4, "goi": 4, "bunpou": 3 },
                    "friday": { "moji": 3, "goi": 4, "bunpou": 4 },
                    "saturday": { "moji": 4, "goi": 4, "bunpou": 4 },
                    "sunday": { "moji": 9, "goi": 8, "bunpou": 8 }
                },
                "week3": {
                    "monday": { "moji": 3, "goi": 4, "bunpou": 4 },
                    "tuesday": { "moji": 4, "goi": 4, "bunpou": 3 },
                    "wednesday": { "moji": 4, "goi": 3, "bunpou": 4 },
                    "thursday": { "moji": 3, "goi": 4, "bunpou": 4 },
                    "friday": { "moji": 4, "goi": 4, "bunpou": 3 },
                    "saturday": { "moji": 3, "goi": 4, "bunpou": 4 },
                    "sunday": { "moji": 8, "goi": 10, "bunpou": 9 }
                },
                "week4": {
                    "monday": { "moji": 4, "goi": 4, "bunpou": 4 },
                    "tuesday": { "moji": 4, "goi": 5, "bunpou": 4 },
                    "wednesday": { "moji": 3, "goi": 4, "bunpou": 5 },
                    "thursday": { "moji": 4, "goi": 4, "bunpou": 4 },
                    "friday": { "moji": 4, "goi": 4, "bunpou": 4 },
                    "saturday": { "moji": 4, "goi": 5, "bunpou": 4 },
                    "sunday": { "moji": 10, "goi": 11, "bunpou": 9 }
                }
            }
        };

        // Initialize the application
        function init() {
            populateStudentSelect();
            document.getElementById('studentSelect').addEventListener('change', handleStudentChange);
        }

        function populateStudentSelect() {
            const select = document.getElementById('studentSelect');
            Object.keys(studentData).forEach(student => {
                const option = document.createElement('option');
                option.value = student;
                option.textContent = student;
                select.appendChild(option);
            });
        }

        function handleStudentChange(event) {
            const selectedStudent = event.target.value;
            if (selectedStudent) {
                displayStudentData(selectedStudent, studentData[selectedStudent]);
                document.getElementById('studentData').style.display = 'block';
                document.getElementById('noStudent').style.display = 'none';
            } else {
                document.getElementById('studentData').style.display = 'none';
                document.getElementById('noStudent').style.display = 'block';
            }
        }

        function displayStudentData(studentName, data) {
            calculateOverallStats(data);
            calculateSubjectAnalysis(data);
            displayWeeklyProgress(data);
            drawProgressChart(data);
        }

        function calculateOverallStats(data) {
            let dailyTotalScore = 0;
            let dailyTests = 0;
            let weeklyTotalScore = 0;
            let weeklyTests = 0;
            let bestDayScore = 0;
            let bestDayPercentage = 0;
            let bestDay = '';
            let totalTests = 0;

            Object.keys(data).forEach(week => {
                Object.keys(data[week]).forEach(day => {
                    const dayData = data[week][day];
                    const dayScore = dayData.moji + dayData.goi + dayData.bunpou;
                    totalTests++;

                    if (day === 'sunday') {
                        // Sunday test: 12 moji + 12 goi + 11 bunpou = 35 total
                        weeklyTotalScore += dayScore;
                        weeklyTests++;
                        const percentage = (dayScore / 35) * 100;
                        if (dayScore > bestDayScore) {
                            bestDayScore = dayScore;
                            bestDayPercentage = percentage;
                            bestDay = `${week} ${day} (${percentage.toFixed(1)}%)`;
                        }
                    } else {
                        // Daily test: 5 moji + 5 goi + 5 bunpou = 15 total
                        dailyTotalScore += dayScore;
                        dailyTests++;
                        const percentage = (dayScore / 15) * 100;
                        if (dayScore > bestDayScore) {
                            bestDayScore = dayScore;
                            bestDayPercentage = percentage;
                            bestDay = `${week} ${day} (${percentage.toFixed(1)}%)`;
                        }
                    }
                });
            });

            const dailyAvgPercentage = dailyTests > 0 ? ((dailyTotalScore / dailyTests / 15) * 100).toFixed(1) : 0;
            const weeklyAvgPercentage = weeklyTests > 0 ? ((weeklyTotalScore / weeklyTests / 35) * 100).toFixed(1) : 0;

            document.getElementById('dailyAvg').textContent = `${dailyAvgPercentage}%`;
            document.getElementById('weeklyAvg').textContent = `${weeklyAvgPercentage}%`;
            document.getElementById('totalTests').textContent = totalTests;
            document.getElementById('bestDay').textContent = bestDay;
        }

        function calculateSubjectAnalysis(data) {
            let mojiTotal = 0, goiTotal = 0, bunpouTotal = 0;
            let mojiMax = 0, goiMax = 0, bunpouMax = 0;

            Object.keys(data).forEach(week => {
                Object.keys(data[week]).forEach(day => {
                    const dayData = data[week][day];
                    mojiTotal += dayData.moji;
                    goiTotal += dayData.goi;
                    bunpouTotal += dayData.bunpou;
                    
                    if (day === 'sunday') {
                        // Sunday: 12 questions each for moji/goi, 11 for bunpou
                        mojiMax += 12;
                        goiMax += 12;
                        bunpouMax += 11;
                    } else {
                        // Daily: 5 questions each
                        mojiMax += 5;
                        goiMax += 5;
                        bunpouMax += 5;
                    }
                });
            });

            const mojiPercentage = ((mojiTotal / mojiMax) * 100).toFixed(1);
            const goiPercentage = ((goiTotal / goiMax) * 100).toFixed(1);
            const bunpouPercentage = ((bunpouTotal / bunpouMax) * 100).toFixed(1);

            document.getElementById('mojiAvg').textContent = `${mojiPercentage}%`;
            document.getElementById('goiAvg').textContent = `${goiPercentage}%`;
            document.getElementById('bunpouAvg').textContent = `${bunpouPercentage}%`;

            // Determine strengths and weaknesses
            const avgScores = [
                { subject: 'moji', score: parseFloat(mojiPercentage), element: 'mojiStrength' },
                { subject: 'goi', score: parseFloat(goiPercentage), element: 'goiStrength' },
                { subject: 'bunpou', score: parseFloat(bunpouPercentage), element: 'bunpouStrength' }
            ];

            const maxScore = Math.max(...avgScores.map(s => s.score));
            const minScore = Math.min(...avgScores.map(s => s.score));

            avgScores.forEach(item => {
                const element = document.getElementById(item.element);
                if (item.score === maxScore && maxScore > minScore + 5) {
                    element.textContent = 'Strength';
                    element.className = 'strength-indicator strength';
                } else if (item.score === minScore && minScore < maxScore - 5) {
                    element.textContent = 'Needs Work';
                    element.className = 'strength-indicator weakness';
                } else {
                    element.textContent = 'Good';
                    element.className = 'strength-indicator neutral';
                }
            });
        }

        function displayWeeklyProgress(data) {
            const weekGrid = document.getElementById('weekGrid');
            weekGrid.innerHTML = '';

            Object.keys(data).forEach(week => {
                const weekCard = document.createElement('div');
                weekCard.className = 'week-card';

                const weekHeader = document.createElement('div');
                weekHeader.className = 'week-header';
                weekHeader.textContent = week.replace('week', 'Week ');

                const weekContent = document.createElement('div');
                weekContent.className = 'week-content';

                Object.keys(data[week]).forEach(day => {
                    const dayData = data[week][day];
                    const dayScore = document.createElement('div');
                    dayScore.className = 'day-score';
                    
                    if (day === 'sunday') {
                        dayScore.classList.add('sunday-special');
                    }

                    dayScore.innerHTML = `
                        <span class="day-name">${day.charAt(0).toUpperCase() + day.slice(1)}</span>
                        <div class="scores">
                            <span class="score-item moji-score">${dayData.moji}</span>
                            <span class="score-item goi-score">${dayData.goi}</span>
                            <span class="score-item bunpou-score">${dayData.bunpou}</span>
                        </div>
                    `;

                    weekContent.appendChild(dayScore);
                });

                weekCard.appendChild(weekHeader);
                weekCard.appendChild(weekContent);
                weekGrid.appendChild(weekCard);
            });
        }

        function drawProgressChart(data) {
            const canvas = document.getElementById('progressChart');
            const ctx = canvas.getContext('2d');
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const days = [];
            const mojiPercentages = [];
            const goiPercentages = [];
            const bunpouPercentages = [];

            Object.keys(data).forEach(week => {
                Object.keys(data[week]).forEach(day => {
                    const dayData = data[week][day];
                    days.push(`${week.replace('week', 'W')} ${day.substring(0, 3)}`);
                    
                    if (day === 'sunday') {
                        // Sunday test percentages: 12 moji, 12 goi, 11 bunpou
                        mojiPercentages.push((dayData.moji / 12) * 100);
                        goiPercentages.push((dayData.goi / 12) * 100);
                        bunpouPercentages.push((dayData.bunpou / 11) * 100);
                    } else {
                        // Daily test percentages: 5 each
                        mojiPercentages.push((dayData.moji / 5) * 100);
                        goiPercentages.push((dayData.goi / 5) * 100);
                        bunpouPercentages.push((dayData.bunpou / 5) * 100);
                    }
                });
            });

            const maxPercentage = 100; // Since we're using percentages
            const chartHeight = 250;
            const chartWidth = canvas.width - 100;
            const startX = 80;
            const startY = 30;

            // Draw grid lines
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 10; i++) {
                const percentage = i * 10;
                const y = startY + (chartHeight * (100 - percentage)) / 100;
                ctx.beginPath();
                ctx.moveTo(startX, y);
                ctx.lineTo(startX + chartWidth, y);
                ctx.stroke();
                
                // Y-axis labels
                ctx.fillStyle = '#666';
                ctx.font = '12px Arial';
                ctx.fillText(percentage + '%', startX - 30, y + 4);
            }

            // Draw connected lines with points
            const drawLine = (percentages, color) => {
                ctx.strokeStyle = color;
                ctx.lineWidth = 3;
                ctx.beginPath();
                
                percentages.forEach((percentage, index) => {
                    const x = startX + (chartWidth * index) / (percentages.length - 1);
                    const y = startY + (chartHeight * (100 - percentage)) / 100;
                    
                    if (index === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });
                
                ctx.stroke();

                // Draw points after lines to ensure they appear on top
                ctx.fillStyle = color;
                percentages.forEach((percentage, index) => {
                    const x = startX + (chartWidth * index) / (percentages.length - 1);
                    const y = startY + (chartHeight * (100 - percentage)) / 100;
                    
                    ctx.beginPath();
                    ctx.arc(x, y, 5, 0, 2 * Math.PI);
                    ctx.fill();
                });
            };

            drawLine(mojiPercentages, '#1565c0');
            drawLine(goiPercentages, '#7b1fa2');
            drawLine(bunpouPercentages, '#2e7d32');

            // X-axis labels
            ctx.fillStyle = '#666';
            ctx.font = '10px Arial';
            days.forEach((day, index) => {
                if (index % 2 === 0) { // Show every other day to avoid crowding
                    const x = startX + (chartWidth * index) / (days.length - 1);
                    ctx.save();
                    ctx.translate(x, startY + chartHeight + 20);
                    ctx.rotate(-Math.PI / 4);
                    ctx.fillText(day, 0, 0);
                    ctx.restore();
                }
            });

            // Add title
            ctx.fillStyle = '#333';
            ctx.font = 'bold 14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Performance Percentage Over Time', canvas.width / 2, 20);
            ctx.textAlign = 'start';
        }

        // Initialize when page loads
        window.addEventListener('load', init);
    </script>
</body>
</html>